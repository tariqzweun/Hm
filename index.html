<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>HM — أزياء نسائية (دمشق - باب توما)</title>
  <meta name="description" content="HM - متجر أزياء نسائية صيفية وشتوية في دمشق - باب توما" />
  <style>
    /* ========== Reset & base ========== */
    *{box-sizing:border-box}html,body{height:100%;margin:0;font-family:Inter, "Segoe UI", Tahoma, Arial, sans-serif;background:#f5f7fb;color:#0f1724; -webkit-font-smoothing:antialiased}
    a{color:inherit;text-decoration:none}
    button{font-family:inherit}
    .container{max-width:1200px;margin:0 auto;padding:0 16px}

    /* ========== Header ========== */
    header{position:sticky;top:0;z-index:80;background:#fff;border-bottom:1px solid #eef2f7}
    .header-inner{display:flex;align-items:center;justify-content:space-between;gap:16px;padding:12px 0}
    .brand{display:flex;align-items:center;gap:12px}
    .brand img{height:48px;width:auto}
    nav.desktop{display:flex;gap:18px;align-items:center}
    nav.desktop a{font-size:14px;color:#334155;padding:6px 4px}
    .actions{display:flex;gap:10px;align-items:center}
    .search-input{display:flex;align-items:center;background:#fff;border:1px solid #e6e9ef;border-radius:10px;padding:6px;height:40px}
    .search-input input{border:0;outline:0;padding:8px;width:220px;font-size:14px}
    .icon-btn{background:#fff;border:1px solid #e6e9ef;border-radius:10px;padding:8px;cursor:pointer;height:40px;display:inline-flex;align-items:center;justify-content:center}
    .cart-bubble{position:relative}
    .cart-bubble .count{position:absolute;left:-8px;top:-8px;background:#ef4444;color:#fff;border-radius:999px;padding:2px 7px;font-size:12px}

    /* hamburger (mobile) */
    .hamburger{display:none;background:transparent;border:0;padding:8px;cursor:pointer}
    .hamburger .bar{width:22px;height:2px;margin:4px 0;background:#0f1724;border-radius:2px}

    /* ========== Hero ========== */
    .hero{margin:18px 0;border-radius:14px;overflow:hidden;position:relative;background-image:url('https://via.placeholder.com/1600x420?text=HM+Banner');background-size:cover;background-position:center}
    .hero::after{content:"";position:absolute;inset:0;background:linear-gradient(90deg,rgba(2,6,23,0.55),rgba(2,6,23,0.2))}
    .hero-inner{position:relative;padding:44px 28px;color:#fff;display:flex;align-items:center;justify-content:space-between;gap:18px}
    .hero-text h1{margin:0;font-size:28px;font-weight:700}
    .hero-text p{margin:6px 0 0;color:rgba(255,255,255,0.9)}

    /* ========== Layout ========== */
    .layout{display:grid;grid-template-columns:260px 1fr;gap:20px;align-items:start;margin-bottom:20px}
    aside.filters{background:#fff;padding:14px;border-radius:12px;border:1px solid #eef2f7;box-shadow:0 8px 24px rgba(15,23,42,0.03)}
    aside .section-title{font-weight:700;margin-bottom:10px}
    .filter-row{margin-bottom:14px}
    .colors{display:flex;flex-wrap:wrap;gap:8px}
    .color-chip{padding:6px 10px;border-radius:8px;border:1px solid #e6e9ef;cursor:pointer;font-size:13px}
    .color-chip.active{background:#111827;color:#fff;border-color:transparent}
    .sizes label{display:inline-flex;align-items:center;gap:8px;margin:6px 6px 6px 0}
    .price-range input{width:100%;padding:8px;border-radius:8px;border:1px solid #e6e9ef}

    /* collapse on mobile */
    .filters .collapse-toggle{display:none}

    /* ========== Products ========== */
    .products-top{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
    .products-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:16px}
    .card{background:#fff;border-radius:12px;overflow:hidden;border:1px solid #eef2f7;display:flex;flex-direction:column;transition:transform .18s ease,box-shadow .18s ease}
    .card:hover{transform:translateY(-6px);box-shadow:0 14px 40px rgba(15,23,42,0.08)}
    .card .media{aspect-ratio:4/5;background:#f3f4f6;display:flex;align-items:center;justify-content:center;overflow:hidden}
    .card .media img{width:100%;height:100%;object-fit:cover}
    .card-body{padding:12px;display:flex;flex-direction:column;gap:8px;flex:1}
    .card-title{font-weight:600}
    .card-sub{font-size:13px;color:#64748b}
    .price{font-weight:800}
    .card-actions{display:flex;gap:8px;margin-top:auto}
    .btn{padding:8px 12px;border-radius:10px;border:1px solid #e6e9ef;background:#fff;cursor:pointer}
    .btn.dark{background:#0f1724;color:#fff;border:0}
    .small-tag{background:#f1f5f9;padding:4px 8px;border-radius:999px;font-size:12px}

    /* quick view modal */
    .modal{position:fixed;inset:0;background:rgba(2,6,23,0.45);display:flex;align-items:center;justify-content:center;padding:20px;z-index:120;display:none}
    .modal.active{display:flex}
    .modal-card{background:#fff;border-radius:12px;max-width:900px;width:100;display:grid;grid-template-columns:1fr 1fr;gap:18px;padding:18px}
    .modal-card .media{aspect-ratio:4/5}
    .modal-body h3{margin:0 0 8px}
    .qty-control{display:flex;align-items:center;gap:8px;margin-top:10px}
    .qty-control button{width:34px;height:34px;border-radius:8px;border:1px solid #e6e9ef;background:#fff;cursor:pointer}

    /* ========== Cart drawer ========== */
    .cart-drawer{position:fixed;top:0;bottom:0;right:0;width:360px;background:#fff;box-shadow:-24px 0 40px rgba(2,6,23,0.12);transform:translateX(110%);transition:transform .28s ease;z-index:130;padding:18px;display:flex;flex-direction:column;gap:12px}
    .cart-drawer.open{transform:translateX(0)}
    .cart-item{display:flex;gap:12px;align-items:center;border-bottom:1px dashed #eef2f7;padding-bottom:10px}
    .cart-item img{width:64px;height:64px;object-fit:cover;border-radius:8px}
    .cart-footer{margin-top:auto}
    .checkout-btn{width:100%;padding:12px;border-radius:10px;background:#111827;color:#fff;border:0;cursor:pointer;font-weight:700}

    /* offers */
    .offers-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:16px;margin-top:20px}
    .offer-card{background:#fff;padding:12px;border-radius:12px;border:1px solid #eef2f7;display:flex;gap:12px;align-items:center}

    /* pagination */
    .pagination{display:flex;gap:8px;justify-content:center;margin-top:18px}
    .page-btn{padding:8px 12px;border-radius:10px;border:1px solid #e6e9ef;background:#fff;cursor:pointer}
    .page-btn.active{background:#0f1724;color:#fff;border:0}

    /* footer */
    footer{margin-top:30px;padding:20px 0;text-align:center;color:#64748b;font-size:14px}

    /* ========== Responsive ========== */
    @media (max-width:980px){
      .products-grid{grid-template-columns:repeat(2,1fr)}
      .offers-grid{grid-template-columns:repeat(2,1fr)}
      .layout{grid-template-columns:1fr}
      .brand img{height:44px}
      nav.desktop{display:none}
      .hamburger{display:inline-block}
      .search-input input{width:120px}
      .filters .collapse-toggle{display:block;margin-bottom:12px}
      aside.filters{display:none}
      aside.filters.open{display:block}
      .modal-card{grid-template-columns:1fr}
      .cart-drawer{width:100%;max-width:420px}
    }
    @media (max-width:560px){
      .products-grid{grid-template-columns:1fr}
      .offers-grid{grid-template-columns:1fr}
      .hero-inner{padding:28px}
      .hero-text h1{font-size:22px}
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Header -->
    <header>
      <div class="header-inner">
        <div style="display:flex;align-items:center;gap:12px">
          <button class="hamburger" id="hamburgerBtn" aria-label="قائمة">
            <span class="bar"></span><span class="bar"></span><span class="bar"></span>
          </button>
          <div class="brand">
            <!-- استبدل الرابط لاحقاً بـ images/hm-logo.png أو رابطك -->
            <img src="Hm.jpg" alt="HM">
            <div style="font-size:13px;color:#334155">HM</div>
          </div>
        </div>

        <nav class="desktop" id="mainNav">
          <a href="#">الرئيسية</a>
          <a href="#">جديد</a>
          <a href="#">الملابس</a>
          <a href="#">عروض</a>
          <a href="#">اتصل</a>
        </nav>

        <div class="actions">
          <div class="search-input" role="search">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" style="opacity:.7">
              <path d="M21 21l-4.35-4.35" stroke="#334155" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
              <circle cx="11" cy="11" r="6" stroke="#334155" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <input id="searchInput" placeholder="ابحث عن منتج، لون، مقاس..." />
          </div>
          <button class="icon-btn" id="favoritesBtn" title="المفضلة">
            ❤️
          </button>
          <div class="cart-bubble">
            <button class="icon-btn" id="cartBtn" title="عربة التسوق">
              🛒
            </button>
            <div class="count" id="cartCount" style="display:none">0</div>
          </div>
        </div>
      </div>
      <!-- Mobile nav (slideover) -->
      <div id="mobileNav" style="display:none;padding:12px 0;border-top:1px solid #eef2f7">
        <nav style="display:flex;flex-direction:column;gap:8px">
          <a href="#">الرئيسية</a>
          <a href="#">جديد</a>
          <a href="#">الملابس</a>
          <a href="#">عروض</a>
          <a href="#">اتصل</a>
        </nav>
      </div>
    </header>

    <!-- Hero -->
    <section class="hero" role="region" aria-label="بانر">
      <div class="hero-inner">
        <div class="hero-text">
          <h1>مرحباً بكِ في HM</h1>
          <p>أحدث صيحات الأزياء النسائية — صيف & شتاء — دمشق، باب توما</p>
        </div>
        <div style="display:flex;flex-direction:column;gap:8px;align-items:flex-end">
          <span class="small-tag">شحن داخل دمشق</span>
          <a href="#products" class="btn dark" style="padding:10px 16px">تسوقي الآن</a>
        </div>
      </div>
    </section>

    <!-- Main layout -->
    <main>
      <div class="layout">
        <!-- Filters / Sidebar -->
        <aside class="filters" id="filtersPanel">
          <div class="collapse-toggle">
            <button id="closeFilters" class="btn">إغلاق</button>
          </div>

          <div class="filter-row">
            <div class="section-title">الأقسام</div>
            <div style="display:flex;flex-direction:column;gap:8px;margin-top:8px">
              <a href="#" class="btn" data-cat="all">الكل</a>
              <a href="#" class="btn" data-cat="dresses">فساتين</a>
              <a href="#" class="btn" data-cat="outer">معاطف وجاكيتات</a>
              <a href="#" class="btn" data-cat="tops">بلوزات</a>
            </div>
          </div>

          <div class="filter-row">
            <div class="section-title">الألوان</div>
            <div class="colors" id="colorsWrap"></div>
          </div>

          <div class="filter-row">
            <div class="section-title">المقاسات</div>
            <div class="sizes" id="sizesWrap"></div>
          </div>

          <div class="filter-row">
            <div class="section-title">السعر (SYP)</div>
            <div style="display:flex;gap:8px;margin-top:8px">
              <input id="minPrice" type="number" placeholder="الحد الأدنى" style="width:120px;padding:8px;border-radius:8px;border:1px solid #e6e9ef">
              <input id="maxPrice" type="number" placeholder="الحد الأعلى" style="width:120px;padding:8px;border-radius:8px;border:1px solid #e6e9ef">
            </div>
          </div>

          <div style="display:flex;gap:8px;margin-top:8px">
            <button class="btn dark" id="applyFilters">تطبيق</button>
            <button class="btn" id="clearFilters">مسح</button>
          </div>
        </aside>

        <!-- Products -->
        <section>
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
            <div style="display:flex;flex-direction:column">
              <h2 id="sectionTitle" style="margin:0">جديدنا</h2>
              <div class="muted" id="resultsInfo">عرض 0 منتج</div>
            </div>
            <div style="display:flex;gap:8px;align-items:center">
              <label class="muted">ترتيب:</label>
              <select id="sortSel" style="padding:8px;border-radius:8px;border:1px solid #e6e9ef">
                <option value="default">الافتراضي</option>
                <option value="priceAsc">السعر: تصاعدي</option>
                <option value="priceDesc">السعر: تنازلي</option>
                <option value="name">الاسم</option>
              </select>
            </div>
          </div>

          <div id="products" class="products-grid" aria-live="polite"></div>

          <div class="pagination" id="pagination"></div>

          <!-- Offers -->
          <section style="margin-top:26px">
            <h3 style="margin:0 0 12px">عروض خاصة</h3>
            <div class="offers-grid" id="offersGrid"></div>
          </section>
        </section>
      </div>
    </main>

    <!-- Footer -->
    <footer>
      <div>HM — أزياء نسائية صيفية وشتوية</div>
      <div>دمشق — باب توما</div>
      <div style="margin-top:8px;color:#94a3b8">© 2025 HM</div>
    </footer>
  </div>

  <!-- Quick view modal -->
  <div class="modal" id="quickModal" role="dialog" aria-modal="true">
    <div class="modal-card" role="document">
      <div class="media"><img id="modalImg" src="" alt=""></div>
      <div class="modal-body">
        <h3 id="modalTitle"></h3>
        <div class="muted" id="modalColor"></div>
        <div style="margin-top:8px;font-weight:800" id="modalPrice"></div>
        <div style="margin-top:12px">المقاسات:</div>
        <div id="modalSizes" style="display:flex;gap:8px;margin-top:8px"></div>
        <div class="qty-control">
          <label>الكمية:</label>
          <button id="qtyMinus">−</button>
          <input id="qtyVal" value="1" style="width:44px;text-align:center;border:1px solid #e6e9ef;border-radius:8px;padding:6px">
          <button id="qtyPlus">+</button>
        </div>
        <div style="margin-top:12px;display:flex;gap:8px">
          <button class="btn dark" id="modalAdd">أضف إلى السلة</button>
          <button class="btn" id="modalClose">إغلاق</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Cart drawer -->
  <aside class="cart-drawer" id="cartDrawer" aria-label="عربة التسوق">
    <h3 style="margin:0">عربتك</h3>
    <div id="cartItems" style="overflow:auto;max-height:60vh;margin-top:10px"></div>
    <div class="cart-footer">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-top:12px">
        <div>المجموع:</div>
        <div style="font-weight:800" id="cartTotal">0 SYP</div>
      </div>
      <button class="checkout-btn" id="checkoutBtn" style="margin-top:12px">الدفع</button>
      <button class="btn" id="closeCart" style="margin-top:8px">متابعة التسوق</button>
    </div>
  </aside>

  <script>
    /* ================== بيانات المنتجات — استبدل الصور بروابطك ================== */
    const PRODUCTS = [
      {id:1,sku:'HM-001',name:'فستان صيفي ناعم',price:139000,color:'زهري',sizes:['S','M','L'],img:'C1.jpg',category:'dresses'},
      {id:2,sku:'HM-002',name:'جاكيت شتوي',price:299000,color:'أسود',sizes:['M','L','XL'],img:'C.jpg',category:'outer'},
      {id:3,sku:'HM-003',name:'بلوزة دانتيل أنيقة',price:89000,color:'أبيض',sizes:['XS','S','M'],img:'C.jpg',category:'tops'},
      {id:4,sku:'HM-004',name:'تنورة جينز',price:149000,color:'أزرق',sizes:['S','M','L'],img:'https://via.placeholder.com/600x750?text=Skirt+1',category:'dresses'},
      {id:5,sku:'HM-005',name:'معطف شتوي طويل',price:399000,color:'رمادي',sizes:['L','XL'],img:'https://via.placeholder.com/600x750?text=Coat+1',category:'outer'},
      {id:6,sku:'HM-006',name:'فستان سهرة',price:249000,color:'أحمر',sizes:['S','M','L'],img:'https://via.placeholder.com/600x750?text=Evening+1',category:'dresses'},
      {id:7,sku:'HM-007',name:'تونيك مريح',price:99000,color:'بيج',sizes:['S','M'],img:'https://via.placeholder.com/600x750?text=Tunic+1',category:'tops'},
      {id:8,sku:'HM-008',name:'بلوزة قطنية',price:79000,color:'أسود',sizes:['XS','S','M'],img:'https://via.placeholder.com/600x750?text=Top+2',category:'tops'},
      {id:9,sku:'HM-009',name:'فستان ميدي',price:179000,color:'وردي',sizes:['S','M','L'],img:'https://via.placeholder.com/600x750?text=Dress+2',category:'dresses'},
      {id:10,sku:'HM-010',name:'بومبر قصير',price:129000,color:'رمادي',sizes:['M','L'],img:'https://via.placeholder.com/600x750?text=Bomber+1',category:'outer'}
    ];

    const OFFERS = [
      {id:101,name:'وشاح شتوي',price:25000,img:'C2.jpg'},
      {id:102,name:'حقيبة جلدية',price:79000,img:'https://via.placeholder.com/600x400?text=Bag'},
      {id:103,name:'حذاء عصري',price:119000,img:'https://via.placeholder.com/600x400?text=Shoes'}
    ];

    /* ================== حالة التطبيق ================== */
    const state = {
      q:'',
      color:null,
      sizes: new Set(),
      minPrice: null,
      maxPrice: null,
      sort: 'default',
      category: 'all',
      page: 1,
      perPage: 6,
      cart: []
    };

    /* ================== عناصر DOM ================== */
    const el = id => document.getElementById(id);
    const productsEl = el('products');
    const offersEl = el('offersGrid');
    const colorsWrap = el('colorsWrap');
    const sizesWrap = el('sizesWrap');
    const resultsInfo = el('resultsInfo');
    const paginationEl = el('pagination');
    const cartCountEl = el('cartCount');
    const cartDrawer = el('cartDrawer');
    const cartItemsEl = el('cartItems');
    const cartTotalEl = el('cartTotal');
    const quickModal = el('quickModal');

    /* ================== أدوات مساعدة ================== */
    const unique = (arr, key) => [...new Set(arr.map(a => a[key]).flat())];
    const formatPrice = p => p.toLocaleString() + ' SYP';

    /* ========= بناء واجهة الفلاتر (ألوان، مقاسات) ========= */
    function buildFilterUI(){
      const colors = [...new Set(PRODUCTS.map(p=>p.color))];
      colorsWrap.innerHTML = '';
      colors.forEach(c=>{
        const btn = document.createElement('button');
        btn.className = 'color-chip';
        btn.textContent = c;
        btn.onclick = () => { state.color = state.color === c ? null : c; state.page=1; render(); updateFilterUI(); };
        colorsWrap.appendChild(btn);
      });

      const sizes = [...new Set(PRODUCTS.flatMap(p=>p.sizes))];
      sizesWrap.innerHTML = '';
      sizes.forEach(s=>{
        const id = 'size-'+s;
        const label = document.createElement('label');
        label.innerHTML = `<input type="checkbox" id="${id}" value="${s}"> ${s}`;
        sizesWrap.appendChild(label);
        label.querySelector('input').addEventListener('change', e => {
          if(e.target.checked) state.sizes.add(s); else state.sizes.delete(s);
          state.page = 1; render();
        });
      });
      updateFilterUI();
    }

    function updateFilterUI(){
      // color active
      [...colorsWrap.children].forEach(btn=>{
        btn.classList.toggle('active', btn.textContent === state.color);
      });
      // sizes checks
      [...sizesWrap.querySelectorAll('input')].forEach(input => {
        input.checked = state.sizes.has(input.value);
      });
    }

    /* ========= فلترة، فرز، وترقيم ========= */
    function getFiltered(){
      let res = PRODUCTS.slice();
      // category
      if(state.category && state.category !== 'all'){
        res = res.filter(p => p.category === state.category);
      }
      // query
      if(state.q){
        const q = state.q.trim().toLowerCase();
        res = res.filter(p => p.name.toLowerCase().includes(q) || (p.color && p.color.toLowerCase().includes(q)));
      }
      // color
      if(state.color) res = res.filter(p => p.color === state.color);
      // sizes
      if(state.sizes.size > 0){
        res = res.filter(p => [...state.sizes].some(s => p.sizes.includes(s)));
      }
      // price
      if(state.minPrice) res = res.filter(p => p.price >= state.minPrice);
      if(state.maxPrice) res = res.filter(p => p.price <= state.maxPrice);
      // sort
      if(state.sort === 'priceAsc') res.sort((a,b)=>a.price-b.price);
      if(state.sort === 'priceDesc') res.sort((a,b)=>b.price-a.price);
      if(state.sort === 'name') res.sort((a,b)=>a.name.localeCompare(b.name));
      return res;
    }

    /* ========= عرض المنتجات ========= */
    function renderProducts(){
      const all = getFiltered();
      const total = all.length;
      const pages = Math.max(1, Math.ceil(total / state.perPage));
      if(state.page > pages) state.page = pages;
      const start = (state.page - 1) * state.perPage;
      const items = all.slice(start, start + state.perPage);

      productsEl.innerHTML = '';
      items.forEach(p => {
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
          <div class="media"><img src="${p.img}" alt="${p.name}"></div>
          <div class="card-body">
            <div>
              <div class="card-title">${p.name}</div>
              <div class="card-sub">رمز: ${p.sku}</div>
            </div>
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div class="price">${formatPrice(p.price)}</div>
              <div style="display:flex;gap:8px">
                <button class="btn" data-action="quick" data-id="${p.id}">عرض سريع</button>
                <button class="btn dark" data-action="add" data-id="${p.id}">أضف</button>
              </div>
            </div>
          </div>
        `;
        productsEl.appendChild(card);
      });

      // pagination
      paginationEl.innerHTML = '';
      for(let i=1;i<=pages;i++){
        const b = document.createElement('button');
        b.className = 'page-btn' + (i === state.page ? ' active' : '');
        b.textContent = i;
        b.addEventListener('click', ()=>{ state.page = i; render(); });
        paginationEl.appendChild(b);
      }

      resultsInfo.textContent = `عرض ${total} منتج`;
    }

    /* ========= عرض العروض ========= */
    function renderOffers(){
      offersEl.innerHTML = '';
      OFFERS.forEach(o=>{
        const card = document.createElement('div');
        card.className = 'offer-card';
        card.innerHTML = `
          <div style="width:90px;height:72px;overflow:hidden;border-radius:8px"><img src="${o.img}" alt="${o.name}" style="width:100%;height:100%;object-fit:cover"></div>
          <div style="flex:1">
            <div style="font-weight:700">${o.name}</div>
            <div style="color:#ef4444;font-weight:800;margin-top:6px">${formatPrice(o.price)}</div>
          </div>
          <div>
            <button class="btn dark" data-action="add-offer" data-id="${o.id}">أضف</button>
          </div>
        `;
        offersEl.appendChild(card);
      });
    }

    /* ========= Quick view modal ========= */
    function openQuick(id){
      const p = PRODUCTS.find(x=>x.id===id);
      if(!p) return;
      el('modalImg').src = p.img;
      el('modalTitle').textContent = p.name;
      el('modalColor').textContent = 'اللون: ' + p.color;
      el('modalPrice').textContent = formatPrice(p.price);
      const sizesWrap = el('modalSizes');
      sizesWrap.innerHTML = '';
      p.sizes.forEach(s => {
        const span = document.createElement('div');
        span.className = 'small-tag';
        span.textContent = s;
        sizesWrap.appendChild(span);
      });
      el('qtyVal').value = 1;
      quickModal.classList.add('active');
      quickModal.dataset.prodId = id;
    }
    function closeQuick(){ quickModal.classList.remove('active'); delete quickModal.dataset.prodId; }

    /* ========= Cart logic ========= */
    function addToCartById(id, qty = 1){
      const p = PRODUCTS.find(x=>x.id===id) || OFFERS.find(x=>x.id===id);
      if(!p) return;
      const existing = state.cart.find(i => i.id === id);
      if(existing) existing.qty += qty;
      else state.cart.push({id:p.id,name:p.name,price:p.price,img:p.img,qty});
      updateCartUI();
      openCart();
    }
    function removeFromCart(id){
      state.cart = state.cart.filter(i=>i.id !== id);
      updateCartUI();
    }
    function changeQtyCart(id, delta){
      const it = state.cart.find(i=>i.id===id);
      if(!it) return;
      it.qty = Math.max(1, it.qty + delta);
      updateCartUI();
    }
    function updateCartUI(){
      const count = state.cart.reduce((s,i)=>s+i.qty,0);
      if(count>0){ cartCountEl.style.display='block'; cartCountEl.textContent = count; } else { cartCountEl.style.display='none'; }
      // items
      cartItemsEl.innerHTML = '';
      state.cart.forEach(it=>{
        const node = document.createElement('div');
        node.className = 'cart-item';
        node.innerHTML = `
          <img src="${it.img}" alt="${it.name}">
          <div style="flex:1">
            <div style="font-weight:700">${it.name}</div>
            <div style="display:flex;gap:8px;align-items:center;margin-top:6px">
              <button class="btn" data-action="dec" data-id="${it.id}">−</button>
              <div>${it.qty}</div>
              <button class="btn" data-action="inc" data-id="${it.id}">+</button>
              <div style="margin-left:auto;font-weight:800">${formatPrice(it.price * it.qty)}</div>
            </div>
          </div>
          <div style="margin-inline-start:8px">
            <button class="btn" data-action="remove" data-id="${it.id}">حذف</button>
          </div>
        `;
        cartItemsEl.appendChild(node);
      });
      const total = state.cart.reduce((s,i)=>s + i.price * i.qty, 0);
      cartTotalEl.textContent = formatPrice(total);
    }
    function openCart(){ cartDrawer.classList.add('open'); }
    function closeCart(){ cartDrawer.classList.remove('open'); }

    /* ========= أحداث DOM العامة ========= */
    // hamburger toggle mobile nav
    document.getElementById('hamburgerBtn').addEventListener('click', ()=>{
      const mobile = document.getElementById('mobileNav');
      mobile.style.display = mobile.style.display === 'block' ? 'none' : 'block';
    });
    // mobile close filters
    document.getElementById('closeFilters').addEventListener('click', ()=>{ document.getElementById('filtersPanel').classList.remove('open'); });

    // search
    el('searchInput').addEventListener('input', e => { state.q = e.target.value; state.page = 1; render(); });

    // category links in sidebar
    [...document.querySelectorAll('aside.filters a[data-cat]')].forEach(a=>{
      a.addEventListener('click', e=>{
        e.preventDefault();
        const cat = a.dataset.cat;
        state.category = cat;
        state.page = 1;
        render();
      });
    });

    // apply & clear filters
    el('applyFilters').addEventListener('click', ()=>{
      state.minPrice = el('minPrice').value ? parseInt(el('minPrice').value) : null;
      state.maxPrice = el('maxPrice').value ? parseInt(el('maxPrice').value) : null;
      state.page = 1;
      render();
    });
    el('clearFilters').addEventListener('click', ()=>{
      state.color = null; state.sizes.clear(); state.minPrice = null; state.maxPrice = null; el('minPrice').value=''; el('maxPrice').value=''; el('searchInput').value=''; state.q=''; state.page=1; buildFilterUI(); render();
    });

    // sort
    el('sortSel').addEventListener('change', e => { state.sort = e.target.value; render(); });

    // product actions (delegation)
    productsEl.addEventListener('click', e => {
      const action = e.target.dataset.action;
      const id = parseInt(e.target.dataset.id);
      if(!action) return;
      if(action === 'quick') openQuick(id);
      if(action === 'add') addToCartById(id,1);
    });

    // offers actions
    offersEl.addEventListener('click', e=>{
      const action = e.target.dataset.action;
      const id = parseInt(e.target.dataset.id);
      if(!action) return;
      if(action === 'add-offer') addToCartById(id,1);
    });

    // modal controls
    el('modalClose').addEventListener('click', closeQuick);
    el('qtyPlus').addEventListener('click', ()=> { el('qtyVal').value = parseInt(el('qtyVal').value || 1) + 1; });
    el('qtyMinus').addEventListener('click', ()=> { el('qtyVal').value = Math.max(1, parseInt(el('qtyVal').value || 1) - 1); });
    el('modalAdd').addEventListener('click', ()=>{
      const id = parseInt(quickModal.dataset.prodId);
      const qty = parseInt(el('qtyVal').value || 1);
      addToCartById(id, qty);
      closeQuick();
    });
    quickModal.addEventListener('click', e=>{ if(e.target === quickModal) closeQuick(); });

    // cart open/close
    el('cartBtn').addEventListener('click', ()=> openCart());
    el('closeCart').addEventListener('click', ()=> closeCart());
    el('checkoutBtn').addEventListener('click', ()=> { alert('نموذج دفع تجريبي — أكمل التكامل مع بوابة الدفع'); });

    // cart item actions (delegation)
    cartItemsEl.addEventListener('click', e=>{
      const action = e.target.dataset.action;
      const id = parseInt(e.target.dataset.id);
      if(!action) return;
      if(action === 'remove') removeFromCart(id);
      if(action === 'inc') changeQtyCart(id, +1);
      if(action === 'dec') changeQtyCart(id, -1);
    });

    // close quick on ESC
    document.addEventListener('keydown', e=>{ if(e.key === 'Escape'){ closeQuick(); closeCart(); document.getElementById('mobileNav').style.display='none';}});

    /* ========= init ========= */
    buildFilterUI();
    renderProducts();
    renderOffers();
    updateCartUI();

    /* لمس: ازرار الانتقال الهاتفي - يجعل تجربة أسلس */
    // في حال بدك تضيف روابط حقيقية لقسم/منتجات، غيّر hrefs أو أضف page routes.
  </script>
</body>
</html>page routes.
  </script>
</body>
</html>pt>
</body>
</html>cript>
</body>
</html>ف page routes.
  </script>
</body>
</html>ف page routes.
  </script>
</body>
</html>ody>
</html>